<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>Loopss.me</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> -->
    <link rel="shortcut icon" href="./img/icon.png">
    <!-- web3 -->
    <script src="./js/web3.min.js"></script>

    <script language="javascript" type="text/javascript" src="./js/ABI_Loop.js"></script>


    <!-- vue.js -->
    <!-- 开发环境版本，包含了有帮助的命令行警告 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> -->
    <script src="./js/jquery.min.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/clipboard.min.js"></script>
    <script src="./js/cytoscape.min.js"></script>
    <script src="./js/cytoscape-cxtmenu.js"></script>
    <!-- 生产环境版本，优化了尺寸和速度 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->
    <script src="./js/vue.js"></script>
    <!-- css -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="./css/bootstrap.min.css" crossorigin="anonymous">
    <link type="text/css" rel="styleSheet" href="./css/neon.css" />

    <!-- 强制刷新免遗留 -->
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache, must-revalidate">
    <meta http-equiv="expires" content="0">
</head>

<style scoped>
    #cy {
        position: relative;
        width: 100%;
        height: 30rem;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        z-index: 999;
    }

    body {
        padding: 1vh;
        /* background-image: url(./img/fqzdj.jpg);
        background-repeat: repeat;
        background-color: #E6E6E6; */
        background-color: #111;
        overflow-x: hidden;
        /* overflow-y: hidden;   */
    }

    svg,
    canvas {
        text-align: center;
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
        width: 100%;
        height: 100%;
    }

    .dropdown-item {
        cursor: pointer;
    }
</style>

<body bgcolor="#E6E6FA">
    <!-- <canvas></canvas>

    <script>
        const STAR_COUNT = (window.innerWidth + window.innerHeight) / 8,
            STAR_SIZE = 3,
            STAR_MIN_SCALE = 0.2,
            OVERFLOW_THRESHOLD = 50;

        const canvas = document.querySelector('canvas'),
            context = canvas.getContext('2d');

        let scale = 1, // device pixel ratio
            width,
            height;

        let stars = [];

        let pointerX,
            pointerY;

        let velocity = { x: 0, y: 0, tx: 0, ty: 0, z: 0.0005 };

        let touchInput = false;

        generate();
        resize();
        step();

        window.onresize = resize;
        // canvas.onmousemove = onMouseMove;
        // canvas.ontouchmove = onTouchMove;
        // canvas.ontouchend = onMouseLeave;
        window.onmousemove = onMouseMove;
        window.ontouchmove = onTouchMove;
        window.ontouchend = onMouseLeave;
        document.onmouseleave = onMouseLeave;

        function generate() {

            for (let i = 0; i < STAR_COUNT; i++) {
                stars.push({
                    x: 0,
                    y: 0,
                    z: STAR_MIN_SCALE + Math.random() * (1 - STAR_MIN_SCALE)
                });
            }

        }

        function placeStar(star) {

            star.x = Math.random() * width;
            star.y = Math.random() * height;

        }

        function recycleStar(star) {

            let direction = 'z';

            let vx = Math.abs(velocity.x),
                vy = Math.abs(velocity.y);

            if (vx > 1 || vy > 1) {
                let axis;

                if (vx > vy) {
                    axis = Math.random() < vx / (vx + vy) ? 'h' : 'v';
                }
                else {
                    axis = Math.random() < vy / (vx + vy) ? 'v' : 'h';
                }

                if (axis === 'h') {
                    direction = velocity.x > 0 ? 'l' : 'r';
                }
                else {
                    direction = velocity.y > 0 ? 't' : 'b';
                }
            }

            star.z = STAR_MIN_SCALE + Math.random() * (1 - STAR_MIN_SCALE);

            if (direction === 'z') {
                star.z = 0.1;
                star.x = Math.random() * width;
                star.y = Math.random() * height;
            }
            else if (direction === 'l') {
                star.x = -OVERFLOW_THRESHOLD;
                star.y = height * Math.random();
            }
            else if (direction === 'r') {
                star.x = width + OVERFLOW_THRESHOLD;
                star.y = height * Math.random();
            }
            else if (direction === 't') {
                star.x = width * Math.random();
                star.y = -OVERFLOW_THRESHOLD;
            }
            else if (direction === 'b') {
                star.x = width * Math.random();
                star.y = height + OVERFLOW_THRESHOLD;
            }

        }

        function resize() {

            scale = window.devicePixelRatio || 1;

            width = window.innerWidth * scale;
            height = window.innerHeight * scale;

            canvas.width = width;
            canvas.height = height;

            stars.forEach(placeStar);

        }

        function step() {

            context.clearRect(0, 0, width, height);

            update();
            render();

            requestAnimationFrame(step);

        }

        function update() {

            velocity.tx *= 0.96;
            velocity.ty *= 0.96;

            velocity.x += (velocity.tx - velocity.x) * 0.8;
            velocity.y += (velocity.ty - velocity.y) * 0.8;

            stars.forEach((star) => {

                star.x += velocity.x * star.z;
                star.y += velocity.y * star.z;

                star.x += (star.x - width / 2) * velocity.z * star.z;
                star.y += (star.y - height / 2) * velocity.z * star.z;
                star.z += velocity.z;

                // recycle when out of bounds
                if (star.x < -OVERFLOW_THRESHOLD || star.x > width + OVERFLOW_THRESHOLD || star.y < -OVERFLOW_THRESHOLD || star.y > height + OVERFLOW_THRESHOLD) {
                    recycleStar(star);
                }

            });

        }
        function rdm() {
            return String(Math.floor(Math.random() * 256) + ',');
        }
        function render() {

            stars.forEach((star) => {

                context.beginPath();
                context.lineCap = 'round';
                context.lineWidth = STAR_SIZE * star.z * scale;
                context.strokeStyle = 'rgba(255,255,255,' + (0.5 + 0.5 * Math.random()) + ')';
                // context.strokeStyle = 'rgba('+rdm()+rdm()+rdm()+(0.5 + 0.5*Math.random())+')';
                // context.strokeText = "Hello World!";
                context.beginPath();
                context.moveTo(star.x, star.y);

                var tailX = velocity.x * 2,
                    tailY = velocity.y * 2;

                // stroke() wont work on an invisible line
                if (Math.abs(tailX) < 0.1) tailX = 0.5;
                if (Math.abs(tailY) < 0.1) tailY = 0.5;

                context.lineTo(star.x + tailX, star.y + tailY);

                context.stroke();

            });

        }

        function movePointer(x, y) {

            if (typeof pointerX === 'number' && typeof pointerY === 'number') {

                let ox = x - pointerX,
                    oy = y - pointerY;

                velocity.tx = velocity.tx + (ox / 8 * scale) * (touchInput ? 1 : -1);
                velocity.ty = velocity.ty + (oy / 8 * scale) * (touchInput ? 1 : -1);

            }

            pointerX = x;
            pointerY = y;

        }

        function onMouseMove(event) {

            touchInput = false;

            movePointer(event.clientX, event.clientY);

        }

        function onTouchMove(event) {

            touchInput = true;

            movePointer(event.touches[0].clientX, event.touches[0].clientY, true);

            event.preventDefault();

        }

        function onMouseLeave() {

            pointerX = null;
            pointerY = null;

        }
    </script> -->
    <!-- <script src='https://unpkg.com/trianglify@^4/dist/trianglify.bundle.js'></script> -->

    <script language="javascript" type="text/javascript" src="./js/trianglify.bundle.js"></script>
    <script>
        const pattern = trianglify({
            width: window.innerWidth,
            height: window.innerHeight
        })
        document.body.appendChild(pattern.toCanvas())
    </script>

    <!-- <img src="./img/loopss.png
    " style="
width: 90%;
margin: auto;
align-items: center;
position: absolute;
top: 35%;
left: 5%;
"> <audio src="./mp3/use.mp3" controls="controls" loop="loop" preload="auto" style="
    /* display: none; */
">

你的浏览器不支持video元素

</audio>-->
    <div id="app" style="width: 50%;margin: auto; min-width: 64rem;">
        <!-- background-color: rgba('+`255, 0, 255`+, 0.2); -->
        <!-- :style='{background-color:"("+rdm()+rdm()+rdm()+"0.2)"}'> -->
        <header>
            <div class="card" style="background-color: rgba(255, 0, 255, 0.2);">
                <div class="card-body">
                    <span>
                        <span class="neon" onclick="location.reload();"><a
                                style="font-size: 8.5rem;position: absolute; top: -4rem; cursor: pointer;">∞</a><span
                                style="
                                top: 3.1rem;
                                position: relative;
                                text-transform: none;">LNS : {{psLNS}}</span> </a> <img src=""></span>
                        <!-- TODO:将LNS： 去掉，并将psLNS居中。 -->
                    </span>
                    <span style="float: right;">
                        <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
                            <span class="btn-group mr-2" role="group" aria-label="First group"
                                style="background-color: rgba(0, 247, 255, 0.2);">
                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 0}"
                                    @click="changePage(0)">主页页面</button>

                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 1}"
                                    @click="changePage(1)">查询页面</button>
                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 3}"
                                    @click="changePage(3)">社会交易所</button>
                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 4}"
                                    @click="changePage(4)">社交消息</button>
                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 2}"
                                    @click="changePage(2)">LNS域名</button>
                                <button class="dropdown-item btn" :class="{ neon: pageNumber == 5}"
                                    @click="changePage(5)">Info</button>
                            </span>
                        </div>
                        <a>Total Minter: {{TotalSupply}} | </a>
                        <a>BlockHeight: {{blockHeight}} | </a>
                        <a>NetWork: {{netWork}}</a>
                        <div class="form-group form-check " style="position: absolute; cursor: pointer;
                        right: 1rem;
                        bottom: -1rem;">
                            <input type="checkbox" class="form-check-input" id="LNSCheck"
                                @click="toggleLNS = !toggleLNS">
                            <label class="form-check-label badge badge-pill badge-success" for="LNSCheck"
                                style="cursor: pointer;">Loop Name System </label>
                        </div>
                    </span>
                </div>
            </div>
            <div v-if='toggleLNS' class="card" style="background-color: rgba(255, 0, 255, 0.1);">
                <div class="card-body">
                    <h4 class="card-title">Loop name system</h4>
                    <div class="btn-group" role="group" aria-label="First group"
                        style="cursor:pointer;width: 100%;margin-bottom: 5px;">

                        <input type="text" class="form-control" v-model='LNSToAddress' @keyup.enter="LNSResolution"
                            placeholder="Input LNS to get Address" aria-label="LNS">
                        <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                            @click="LNSResolution()" title="MyAddress">👉</button>
                        <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                            @click="LNSReverse()" title="MyAddress">👈</button>
                        <input type="text" class="form-control" v-model='AddressToLNS' @keyup.enter="LNSReverse"
                            placeholder="Input Address to get LNS" aria-label="Address">

                    </div>
                </div>
            </div>
        </header>
        <br>
        <div id="element" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="10000"
            style="position: absolute;right: 1rem;z-index: 2; background-color: rgba(255,215,0,0.4);">
            <div class="toast-header" style="background-color:rgba(255, 215, 0, 0.3)">
                <!-- <img src="./img/nash.ico" class="rounded mr-2" alt="NASH icon" style="width: 1rem;height: 1rem;"> -->
                <img src="./img/icon.png" class="rounded mr-2" alt="Loop∞ icon" style="width: 1rem;height: 1rem;">
                <strong class="mr-auto" style="padding-right: 1rem;">{{toastTitle}}</strong>
                <small> @{{timeNow}}</small>
                <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="toast-body" style="white-space: pre-line;">{{toastContent}}
            </div>
        </div>
        <!-- #0 ——————————————————————————————————————————————————————————————————————————————主页页面 -->
        <span v-if="pageNumber == 0">
            <div class="jumbotron" style="background-color: rgba(230, 0, 0, 0.3);">

                <h1 class="display-4"><b>Hello, human!</b></h1>
                <p class="lead">Loopss 是一套用来构建人类早期<b title="早期村落通过社交信用系统来督促共同生产。而之后由于空间扩大以及货币能力不足而丢失。"
                        style="cursor: pointer;">自然社交经济群体智能</b>的信用&价值映射工具。<br>其底层基于用来实现【通用人工智能AGI】的ACE理论。</p>
                <hr class="my-4">
                <p>区块链只降低了记账方的信任成本，不解决更广范围的信任。信用、社交、缔结组织，仍存在巨大的信任摩擦。我们实现「去中心化信用协议」，让所有地址只需传统 DeFi 百分之一的成本 ,
                    即可发行建立自己的 「Social Token」 与 「Uniswap」。通过从最底层开始构建信用，并为每个信用节点按时间分配信用代币。在这个过程中使得价格完美拟合价值『代币价格*代币产速 =
                    个人单位时间生产量 * 价值』。</p>
                <span style="float: right;">
                    <h2 title="全世界无产者，联合起来！" style="cursor:pointer">通过去中心化信任协议链接彼此</h2>
                    <a class="btn btn-danger btn-lg" style="float: right;" target="_blank"
                        href="https://www.yuque.com/docs/share/c57266fd-29cd-4338-9d53-e3bd0bb679a0?#"
                        role="button">了解更多🚀</a>
                </span>
                <!-- href="https://www.yuque.com/docs/share/e7dd4b11-20b9-4d62-ba4a-e40622fb1071?#" -->
                <br><br>
            </div>
        </span>
        <!-- #1 ——————————————————————————————————————————————————————————————————————————————查询页面 -->
        <span v-if="pageNumber == 1">
            <nav style="float: none;z-index: 1;">
                <div class="row">
                    <div class="col-12">
                        <div class="card" style="background-color: rgba(0, 250, 154, 0.3);">
                            <div class="card-body">
                                <!-- $Loopss contract @:<a target="_blank"
                                    :href="`https://${blockExplorer[netWork]}/address/`+LoopsAddress">{{LoopsAddress}}
                                </a>
                                <br>
                                <br> -->
                                <!-- 关注地址X: -->
                                <h4 class="card-title">我的地址：</h4>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;margin-bottom: 5px;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">My</span>
                                    </div>
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="lookMyAddress = addressNow" title="MyAddress">💫</button>

                                    <input type="text" class="form-control" v-model="lookMyAddress" placeholder="默认自己地址"
                                        @keyup.enter="getMyMinterAndCoinList" aria-label="Address">
                                    <button type="button" class="btn btn-warning" style="width: 10%;"
                                        title="Get 🌊Flowing immediately" @click='getMyMinterAndCoinList()'>Get</button>
                                </div>
                                <!-- TODO：加上代币符号 -->
                                <div style="text-align: center;">
                                    🌊我的信用流代币余额: 💦{{mintedInWalletF}}——💧
                                </div>

                                <!-- <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;">

                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
            <div class="row">
                <div class="col-12">
                    <div class="card" style="width: 100%;margin-bottom: 5px;background-color: rgba(123,104,238,0.3);">
                        <div class="card-body">
                            <h4 class="card-title">Other coin balance in My address</h4>
                            <!-- 点击直接跳转到发送交易界面 -->
                            <div style="max-height: 20rem; overflow: auto;">
                                <div v-for="ycl in YCoinList" class="alert alert-success" role="alert">
                                    <a :href="`https://${blockExplorer[netWork]}/address/`+ycl[0]" target="_blank"
                                        title="打开区块链浏览器">💫</a>
                                    <a style="white-space: pre;cursor: pointer;" class="toCopy" href="#" title="复制地址"
                                        :data-clipboard-text="ycl[0]">【{{ycl[1]}}】</a>
                                    <span style="float: right;">
                                        <a title="开始交易" style="cursor: pointer;" @click="startSwap(ycl[0])">💹</a>
                                        <span>{{_formatBigNumber(ycl[2])}}</span>
                                    </span>
                                </div>
                            </div>
                            <!-- <span style="cursor:pointer;">
                                My address中的Y$<b
                                    style="white-space: pre;">【{{otherMintedLNS}}】</b>代币余额:{{otherMintedInWalletF}}-</span>
                            <div class="btn-group" role="group" aria-label="First group"
                                style="cursor:pointer;width: 100%;">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Y</span>
                                </div>
                                <input type="text" class="form-control" v-model="lookMinterAddress"
                                    @keyup.enter="getMinterBalanceOf" placeholder="Address:0x" aria-label="Address">
                                <button type="button" class="btn " @click="getMinterBalanceOf()"
                                    style="font-size: 2rem;height: 1rem;" title="获取我钱包中该地址的余额">🔍</button>
                            </div>
                            <span v-if="(lookMyAddress == addressNow) && otherMintedInWallet1e18 != 0">
                                <span style="cursor:pointer">-转出Y：【{{otherMintedLNS}}】代币-
                                </span>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">To</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="sendOtherCoinToAddress"
                                        style="width: 70%;" placeholder="Address:0x" aria-label="Address">
                                    <input type="number" class="form-control" v-model="sendOtherCoinAmount"
                                        style="width: 30%;" placeholder="Amount" aria-label="Amount">
                                    <button type="button" class="btn " @click="sendOtherCoin()"
                                        title="转账钱包中的他人代币">🔜</button>
                                </div>
                            </span> -->

                            <!-- <div style="text-align: center;">
                                👽{{otherMintedInWalletF}}👽
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-6">
                    <div class="card" style="width: 100%;background-color: rgba(255,215,0, 0.3);">
                        <div class="card-body">
                            <h4 class="card-title">信任查询</h4>
                            <div class="btn-group" role="group" aria-label="First group"
                                style="cursor:pointer;width: 100%; margin-bottom: 1rem;">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Z</span>
                                </div>
                                <input type="text" class="form-control" v-model="lookTrustAddress"
                                    @keyup.enter="getTrustState" placeholder="Address:0x" aria-label="Address">
                                <button type="button" class="btn btn-info" @click="getTrustState()"
                                    title="查询双向信任关系">↔</button>
                            </div>
                            <br>
                            <div class="alert alert-success" role="alert">
                                <!-- 地址Me对→地址Z的Trust参数： -->
                                <div class="col-12" :title="'Trust confidence:' + trustData.meToHim.portion+'%'"
                                    style="width: 100%;">
                                    <span>My 信任程度</span>
                                    <span class="progress" style="background-color: rgba(255,215,0, 0.3);">
                                        <span class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                            role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                                            :style="'width: '+trustData.meToHim.portion+'%'">
                                            {{trustData.meToHim.portion}}%</span>
                                    </span>
                                </div>
                                [兑换比例
                                {{trustData.meToHim.ratio / 1e18}} Z /1 My]
                            </div>
                            <div class="alert alert-success" role="alert">
                                <!-- 地址Z对→地址Me的Trust参数： -->
                                <div class="col-12" :title="'Trust confidence:' + trustData.heToMe.portion+'%'"
                                    style="width: 100%;">
                                    <span>My 受信程度</span>
                                    <span class="progress" style="background-color: rgba(255,215,0, 0.3);">
                                        <span class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                            role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                                            :style="'width: '+trustData.heToMe.portion+'%'">
                                            {{trustData.heToMe.portion}}%</span>
                                    </span>
                                </div>
                                [兑换比例
                                {{trustData.heToMe.ratio / 1e18}} My /1 Z]
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6" v-if='1'>
                    <div class="card" style="width: 100%;background-color: rgba(255,215,0, 0.3);">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-5">
                                    <h4 class="card-title">Trust Logs</h4>
                                </div>
                                <!-- 这里这样是为了并排 -->
                                <div class="col-7">
                                    <div class="btn-group" role="group" aria-label="Basic example"
                                        style="float: right;">
                                        <button type="button" @click="getMyTrusted()" class="btn btn-light">
                                            I Trusted🤝</button>
                                        <button type="button" @click="getTrustedMe()" class="btn btn-light">
                                            Trusted Me👭</button>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div style="max-height: 15rem;overflow: auto;">
                                <span v-for="tl in trustLogs" class="badge badge-pill badge-success"><a
                                        :href="`https://${blockExplorer[netWork]}/tx/`+tl.transactionHash"
                                        target="_blank" title="Open EtherScan">📑</a>@{{tl.blockNumber}}⛓<a
                                        :title="tl.returnValues.TrustSender" class="toCopy"
                                        :data-clipboard-text="tl.returnValues.TrustSender"
                                        style="cursor: pointer;">{{tl.returnValues.TrustSender.substring(0,5)}}…</a>→{{trustType[tl.returnValues.TrustType]}}→<a
                                        :title="tl.returnValues.BeenTrusted" class="toCopy"
                                        :data-clipboard-text="tl.returnValues.BeenTrusted"
                                        style="cursor: pointer;">{{tl.returnValues.BeenTrusted.substring(0,5)}}…</a>
                                    @{{tl.returnValues.TrustType == 1 ? String(tl.returnValues.TrustValue) + '%' : '1:'+String(tl.returnValues.TrustValue / 1e18)}}</span>
                                <br>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </span>
        <!-- #2 ——————————————————————————————————————————————————————————————————————————————LNS页面 -->
        <span v-if="pageNumber == 2">
            <nav style="float: none;z-index: 1;">
                <div class="row">
                    <div class="col-6">
                        <div class="card" style="background-color: rgba(0, 250, 154, 0.3);">
                            <div class="card-body">

                                <h4 class="card-title">Register LNS</h4>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;margin-bottom: 5px;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">For</span>
                                        <button type="button" class="btn"
                                            style="background-color: rgba(133,199,163, 0.6);"
                                            @click="LNSforAddress = zeroAddress" title="ZeroAddress">🕳</button>
                                        <button type="button" class="btn"
                                            style="background-color: rgba(133,199,163, 0.6);"
                                            @click="LNSforAddress = addressNow" title="MyAddress">💫</button>
                                    </div>
                                    <input type="text" class="form-control" v-model="LNSforAddress"
                                        placeholder="For address">
                                </div>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;margin-bottom: 5px;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">LNS</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="LNSText" @keyup.enter="checkLNS"
                                        placeholder="LNS you want to register" aria-label="Address">
                                    <button type="button" class="btn btn-warning" style="width: 70%;" title="Check Fee"
                                        @click='checkLNS()'>Check-Fee:{{LNSFeeF}}{{coinName[netWork]}}</button>
                                    <button
                                        v-if="(CKAddressToLNS == '') && (CKLNSToAddress == zeroAddress) && (LNSFee1e18 != 0)"
                                        type="button" class="btn btn-success" style="width: 30%;" title="Register LNS"
                                        @click='registerLNS()'>注册</button>
                                </div>
                                <!-- <hr> -->
                                <!-- <h4 class="card-title">(For) address info</h4> -->
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;margin-bottom: 5px;">
                                    <button type="button" class="btn btn-sm btn-info" style="width: 80%;"
                                        title="Check Fee" @click='getAccountInfo()'>(For) address info 🔍</button>
                                    <button v-if="AccountInfoData.beenTrustCount" type="button"
                                        class="btn btn-sm btn-warning" style="width: 20%;" title="Close Info"
                                        @click="AccountInfoData = ''">🔺</button>
                                </div>
                                <!-- 累计收益先放一放，因为这里vue对不存在的值会报错 -->
                                <!-- {{LNSRegisterLog[0].returnValues.NowPerLNS_Profits1e18}}
                                {{_formatBigNumber(String(parseInt(AccountInfoData.realizedLNS_Profits1e18)/1e18))}} -->
                                <span v-if="AccountInfoData.beenTrustCount">
                                    <p>Been Trust Count: {{AccountInfoData.beenTrustCount}}</p>
                                    <p>Inviter: {{AccountInfoData.inviter}}</p>
                                    <p>Last Transfer:
                                        {{AccountInfoData.lastUpdatePoint == 0? 'Never Transfered' :getLocalTime(AccountInfoData.lastUpdatePoint)}}
                                    </p>
                                    <p>LNS: 【{{AccountInfoData.userLNS_LNS}}】<a v-if="AccountInfoData.userLNS_LNS"
                                            class="badge badge-success">Invite Bonus Available</a><a
                                            v-if="!AccountInfoData.userLNS_LNS" class="badge badge-danger">
                                            NO LNS ⚠ Invite Bonus Not Available</a></p>
                                    <p v-if="UnClaimBonus">unClaim Bonus:{{_formatBigNumber(UnClaimBonus)}}
                                        ${{coinName[netWork]}}</p>

                                    <!-- <a href="#" class="badge badge-danger">Danger</a> -->
                                </span>
                                <button v-if="(LNSforAddress == addressNow) && (AccountInfoData.userLNS_LNS)"
                                    type="button" class="btn btn-success" style="width: 100%;" title="Check Fee"
                                    @click='ClaimBonus()'>Claim Community Bonus : {{_formatBigNumber(UnClaimBonus)}}
                                    ${{coinName[netWork]}}</button>
                                <!-- <hr> -->
                                <!-- <h4 class="card-title">Community Bonus</h4> -->
                            </div>
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="card" style="background-color: rgba(0, 250, 154, 0.3);">
                            <div class="card-body">


                                <h4 class="card-title">LNS Logs 📅</h4>

                                <button type="button" class="btn btn-sm btn-info" style="width: 100%;"
                                    title="(For) address LNS logs" @click='getLNSRegisterLog()'>(For) LNS register
                                    log</button>
                                <span v-for='flg in LNSRegisterLog'>

                                    <span class="badge badge-pill badge-success" style="cursor: pointer;"><a
                                            :href="`https://${blockExplorer[netWork]}/tx/`+flg.transactionHash"
                                            target="_blank" title="Open EtherScan">📑</a>@{{flg.blockNumber}}⛓
                                        <a
                                            :title="flg.returnValues.Inviter">{{flg.returnValues.Inviter.substring(0,5)}}…</a>Invited

                                        <a
                                            :title="flg.returnValues.Owner">{{flg.returnValues.Owner.substring(0,5)}}…</a>
                                        <a style="white-space: pre;">←【{{flg.returnValues.LNS}}】</a>
                                        |
                                        Bonus: {{_formatBigNumber(flg.returnValues.Inviter_Bonus)}}
                                        {{coinName[netWork]}}</span>
                                </span>
                                <hr>
                                <!-- TODO:处理overflow -->
                                <button type="button" class="btn btn-sm btn-info" style="width: 100%;"
                                    title="Invited by (for) logs" @click='getLNSInviteLogs()'>(For) address
                                    invited</button>
                                <span v-for='flg in LNSInviteLogs'>

                                    <span class="badge badge-pill badge-success" style="cursor: pointer;"><a
                                            :href="`https://${blockExplorer[netWork]}/tx/`+flg.transactionHash"
                                            target="_blank" title="Open EtherScan">📑</a>@{{flg.blockNumber}}⛓
                                        <a
                                            :title="flg.returnValues.Inviter">{{flg.returnValues.Inviter.substring(0,5)}}…</a>Invited

                                        <a
                                            :title="flg.returnValues.Owner">{{flg.returnValues.Owner.substring(0,5)}}…</a>
                                        <a style="white-space: pre;">←【{{flg.returnValues.LNS}}】</a>
                                        |
                                        Bonus: {{_formatBigNumber(flg.returnValues.Inviter_Bonus)}}
                                        {{coinName[netWork]}}</span>
                                </span>
                                <hr>
                                <!-- TODO:处理overflow -->
                                <button type="button" class="btn btn-sm btn-info" style="width: 100%;"
                                    title="Invited by (for) logs" @click='getAllLNSLogs()'>All LNS logs</button>
                                <div style="overflow: auto;max-height: 15rem;">
                                    <span v-for='flg in AllLNSLogs'>

                                        <span class="badge badge-pill badge-success" style="cursor: pointer;"><a
                                                :href="`https://${blockExplorer[netWork]}/tx/`+flg.transactionHash"
                                                target="_blank" title="Open EtherScan">📑</a>@{{flg.blockNumber}}⛓
                                            <a class="toCopy" :data-clipboard-text="flg.returnValues.Inviter"
                                                :title="flg.returnValues.Inviter">{{flg.returnValues.Inviter.substring(0,5)}}…</a>Invited

                                            <a class="toCopy" :data-clipboard-text="flg.returnValues.Owner"
                                                :title="flg.returnValues.Owner">{{flg.returnValues.Owner.substring(0,5)}}…</a>
                                            <a style="white-space: pre;">←【{{flg.returnValues.LNS}}】</a>
                                            |
                                            Bonus: {{_formatBigNumber(flg.returnValues.Inviter_Bonus)}}
                                            {{coinName[netWork]}}</span>
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- <div class="card" style="background-color: rgba(0, 250, 154, 0.3);">
                            <div class="card-body">

                            </div>
                        </div> -->
                </div>
            </nav>
            <!-- <div class="row">
                <div class="col-12">
                    <div class="card" style="width: 100%;">
                        <div class="card-body">
                            <div class="row" style="margin-bottom: 5px;">
                                <span class="col-9">
                                    <h4 class="card-title"><a>Loop Name System👷🏗🚧</a></h4>
                                </span>
                                <img src="./img/img_LNS.jpg" style="
                                width: 100%;
                                height: 100%;
                            ">
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </span>
        <!-- #3 ——————————————————————————————————————————————————————————————————————————————Swap页面 -->
        <span v-if="pageNumber == 3">
            <nav style="float: none;z-index: 1;">
                <div class="row">
                    <div class="col-12">
                        <div class="card" style="background-color: rgba(0, 250, 154, 0.3);">
                            <div class="card-body">
                                <h4 class="card-title">Loop Swap 链路交易 <span
                                        class="badge badge-pill badge-info">A(?)→B(B)→A</span></h4>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;margin-bottom: 5px;">

                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="loop_lanuchTokenAddress = addressNow" title="MyAddress">💫</button>
                                    <input type="text" class="form-control" v-model="loop_lanuchTokenAddress"
                                        @keyup.enter="checkLaunchBalance" style="width: 80%;"
                                        placeholder="Token you want to use" aria-label="Address">
                                    <button type="button" class="btn btn-warning" style="width: auto;"
                                        title="Check Available"
                                        @click='checkLaunchBalance()'>{{_formatBigNumber(String(loop_lanuchTokenBalance))}}</button>
                                </div>
                                <div v-if="loop_lanuchTokenBalance != 0">


                                    <div class="btn-group" role="group" aria-label="First group"
                                        style="cursor:pointer;width: 100%;margin-bottom: 5px;">
                                        <input type="text" class="form-control" v-model="loop_toSwapTokenAddress"
                                            @keyup.enter="getLoopAvailableAmount" placeholder="Token you want to Swap"
                                            aria-label="Address">
                                        <button type="button" class="btn btn-info" style="width: 50%;"
                                            title="Check Available" @click='getLoopAvailableAmount()'>
                                            Loop Available</button>
                                    </div>
                                    <div style="margin: auto;text-align: center;">
                                        Max Input:{{_formatBigNumber(String(loop_IO.input))}}【{{loop_lanuchTokenLNS}}】→
                                        Max Output:{{_formatBigNumber(String(loop_IO.output))}}【{{loop_toSwapTokenLNS}}】
                                    </div>
                                    <div class="btn-group" role="group" aria-label="First group"
                                        style="cursor:pointer;width: 100%; margin-bottom: 1rem;">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                Input</span>
                                        </div>
                                        <input type="number" class="form-control" v-model="loopInputd1e18" step="0.1"
                                            placeholder="Address:0x" aria-label="Amount">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                {{loop_lanuchTokenLNS}}</span>
                                        </div>
                                        →
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                Output</span>
                                        </div>
                                        <input type="number" class="form-control" v-model="loopOutputd1e18" step="0.1"
                                            placeholder="Address:0x" aria-label="Amount">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                {{loop_toSwapTokenLNS}}</span>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-success" style="width: 100%;"
                                        title="Check Available" @click='loopSwap()'>LoopssSwap!</button>
                                </div>
                                <hr>
                                <h4 class="card-title">Loop Transfer 链路转账 <span
                                        class="badge badge-pill badge-info">A(?)→B</span></h4>

                                <!-- <h5 class="card-title"> 转出钱包中的异币 </h6> -->
                                <span style="cursor:pointer;">
                                    My address 中的Y$<b
                                        style="white-space: pre;">【{{otherMintedLNS}}】</b>代币余额:{{otherMintedInWalletF}}-</span>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">Y</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="lookMinterAddress"
                                        @keyup.enter="getMinterBalanceOf" placeholder="Address:0x" aria-label="Address">
                                    <button type="button" class="btn " @click="getMinterBalanceOf()"
                                        style="font-size: 2rem;height: 1rem;" title="获取我钱包中该地址的余额">🔍</button>
                                </div>
                                <span v-if="(lookMyAddress == addressNow) && otherMintedInWallet1e18 != 0">
                                    <span style="cursor:pointer">-转出Y：【{{otherMintedLNS}}】代币-
                                    </span>
                                    <div class="btn-group" role="group" aria-label="First group"
                                        style="cursor:pointer;width: 100%;">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">To</span>
                                        </div>
                                        <input type="text" class="form-control" v-model="sendOtherCoinToAddress"
                                            style="width: 70%;" placeholder="Address:0x" aria-label="Address">
                                        <input type="number" class="form-control" v-model="sendOtherCoinAmount"
                                            style="width: 30%;" placeholder="Amount" aria-label="Amount">
                                        <button type="button" class="btn " @click="sendOtherCoin()"
                                            title="转账钱包中的他人代币">🔜</button>
                                    </div>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- <div class="row">
                <div class="col-12">
                    <div class="card" style="width: 100%;">
                        <div class="card-body">
                            <div class="row" style="margin-bottom: 5px;">
                                <span class="col-9">
                                    <h4 class="card-title"><a>Social Exchange👷🏗🚧</a></h4>
                                </span>
                                <img src="./img/img_SEX.jpg" style="
                                width: 100%;
                                height: 100%;
                            ">
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </span>
        <!-- #4 ——————————————————————————————————————————————————————————————————————————————SM页面 -->
        <span v-if="pageNumber == 4">
            <div class="row">
                <div class="col-6">
                    <div class="card" style="width: 100%;background-color: rgba(127,220,227, 0.3);">
                        <div class="card-body">
                            <div class="row" style="margin-bottom: 5px;">
                                <span class="col-9">
                                    <h4 class="card-title"><a>Social Message:</a></h4>
                                </span>
                                <div class="btn-group" role="group" aria-label="First group"
                                    style="cursor:pointer;width: 100%; margin-bottom: 1rem;">

                                    <!-- <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">My</span>
                                    </div> -->
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="lookMessageAddress = zeroAddress" title="ZeroAddress">🕳</button>
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="lookMessageAddress = addressNow" title="MyAddress">💫</button>
                                    <input type="text" class="form-control" v-model="lookMessageAddress"
                                        placeholder="Address:0x" aria-label="Address">
                                    <button type="button" class="btn" style="background-color: rgba(202,207,149, 0.6);"
                                        @click="getSentMsg()" title="查询发出的消息">📤</button>
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="getRecMsg()" title="查询接收的消息">📩</button>
                                    <div class="btn-group">
                                        <!-- <button type="button" class="btn btn-info">📶</button> -->
                                        <button type="button" class="btn btn-info dropdown-toggle dropdown-toggle-split"
                                            data-toggle="dropdown" aria-haspopup="true"
                                            aria-expanded="false">📶{{msgGetCL}}
                                            <span class="sr-only">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu" style="background-color: rgba(255,215,0,0.7);">
                                            <a class="dropdown-item" @click="msgGetCL = '∞'" href="#">Channel📶：∞ ——All
                                                Msg</a>
                                            <div class="dropdown-divider"></div>
                                            <!-- <a class="dropdown-item" @click="msgGetCL = 12557" href="#">Channel📶：12557
                                                ——Lite Msg</a> -->
                                            <a class="dropdown-item" @click="msgGetCL = 0" href="#">Channel📶：0
                                                ——Passerby Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 1" href="#">Channel📶：1 ——Mini
                                                Holder Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 10" href="#">Channel📶：10
                                                ——Holder Msg</a>
                                            <!-- <a class="dropdown-item" @click="msgGetCL = 20" href="#">Channel📶：20 ——???
                                                Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 30" href="#">Channel📶：30 ——????
                                                Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 88" href="#">Channel📶：88 ——Fomo
                                                Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 100" href="#">Channel📶：100
                                                ——Senator Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 520" href="#">Channel📶：520
                                                ——Love Msg</a>
                                            <a class="dropdown-item" @click="msgGetCL = 888" href="#">Channel📶：888
                                                ——Fanatic Msg</a> -->
                                            <!-- <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" @click="msgGetCL = 142857"
                                                href="#">Channel📶：142587
                                                ——To Satoshi Nakamoto</a> -->
                                        </div>
                                    </div>
                                    <button type="button" class="btn" style="background-color: rgba(241,210,189, 0.6);"
                                        @click="getAllMsg()" title="All message">👁‍🗨</button>
                                </div>
                                <!-- <div class="input-group-prepend" style="width: 100%;margin-bottom: 5px;">
                                    <span class="input-group-text" id="basic-addon1">Channel📶</span>
                                    <div class="btn-group mr-2" role="group" aria-label="First group">
                                        <button type="button" class="btn btn-secondary">0</button>
                                        <button type="button" class="btn btn-secondary">1</button>
                                        <button type="button" class="btn btn-secondary">2</button>
                                        <button type="button" class="btn btn-secondary">3</button>
                                        <button type="button" class="btn btn-secondary">4</button>
                                        <button type="button" class="btn btn-secondary">5</button>
                                        <button type="button" class="btn btn-secondary">6</button>
                                        <button type="button" class="btn btn-secondary">7</button>
                                        <button type="button" class="btn btn-secondary">8</button>
                                        <button type="button" class="btn btn-secondary">9</button>
                                    </div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="card" style="width: 100%;background-color: rgba(127,220,227, 0.3);">
                        <div class="card-body">
                            <div class="row" style="margin-bottom: 5px;">
                                <span class="col-9">
                                    <h4 class="card-title"><a>Send Message</a></h4>
                                </span>

                                <div class="input-group-prepend" style="width: 100%;margin-bottom: 5px;">
                                    <span class="input-group-text" id="basic-addon1">To</span>
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="MessageSendToAddress = zeroAddress" title="ZeroAddress">🕳</button>
                                    <button type="button" class="btn" style="background-color: rgba(133,199,163, 0.6);"
                                        @click="MessageSendToAddress = addressNow" title="MyAddress">💫</button>
                                    <input type="text" class="form-control" v-model="MessageSendToAddress"
                                        placeholder="SendToAddress:0x" aria-label="Address">
                                </div>

                                <div class="input-group-prepend" style="width: 100%;margin-bottom: 5px;">
                                    <span class="input-group-text" id="basic-addon1">Title</span>
                                    <input type="text" class="form-control" v-model="MessageSendToTitle"
                                        placeholder="Title" aria-label="Title">
                                    <div class="btn-group">
                                        <!-- <button type="button" class="btn btn-info">📶</button> -->
                                        <button type="button" class="btn btn-info dropdown-toggle dropdown-toggle-split"
                                            data-toggle="dropdown" aria-haspopup="true"
                                            aria-expanded="false">📶{{msgSendCL}}
                                            <span class="sr-only">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu" style="background-color:rgba(255,215,0,0.7);">
                                            <a class="dropdown-item" title='Open 《Lite msg documents》'
                                                href="#">Documents📁：12557 ——Lite Msg</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" @click="msgSendCL = 0" href="#">Channel📶：0
                                                ——Passerby Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 1" href="#">Channel📶：1 ——Mini
                                                Holder Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 10" href="#">Channel📶：10
                                                ——Holder Msg</a>
                                            <!-- <a class="dropdown-item" @click="msgSendCL = 20" href="#">Channel📶：20 ——???
                                                Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 30" href="#">Channel📶：30
                                                ——???? Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 88" href="#">Channel📶：88
                                                ——Fomo Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 100" href="#">Channel📶：100
                                                ——Senator Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 520" href="#">Channel📶：520
                                                ——Love Msg</a>
                                            <a class="dropdown-item" @click="msgSendCL = 888" href="#">Channel📶：888
                                                ——Fanatic Msg</a> -->
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group-prepend" style="width: 100%;margin-bottom: 5px;">
                                    <input type="text" class="form-control" v-model="MessageSendToContent"
                                        placeholder="Content" aria-label="Content">
                                    <button type="button" class="btn" @click="sendMsg()"
                                        title="Send Message to Chain">📤</button>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card" style="width: 100%;background-color: rgba(127,220,227, 0.3);">
                        <div class="card-body" style="max-height: 30rem; overflow: auto;">
                            <!-- <div v-for="md in messageDatas" class="alert alert-light" role="alert" style="background-color: rgba(106,181,177, 0.3);">
                                {{md.returnValues.Title}}{{md.returnValues.Content}}
                            </div> -->
                            <div v-for="md in messageDatas" class="card"
                                style="width: 100%;background-color: rgba(106,181,177, 0.3); margin-bottom: 1rem;">
                                <div class="card-body">
                                    <span class="badge badge-pill badge-primary"><a
                                            :href="`https://${blockExplorer[netWork]}/tx/`+md.transactionHash"
                                            target="_blank" title="Open EtherScan">📑</a>@{{md.blockNumber}}⛓<a
                                            :title="md.returnValues.Sender" class="toCopy"
                                            :data-clipboard-text="md.returnValues.Sender"
                                            style="cursor: pointer;">{{md.returnValues.Sender.substring(0,5)}}…</a>→Sent→<a
                                            :title="md.returnValues.Receiver" class="toCopy"
                                            :data-clipboard-text="md.returnValues.Receiver"
                                            style="cursor: pointer;">{{md.returnValues.Receiver.substring(0,5)}}…</a> |
                                        Channel📶{{md.returnValues.Channel}}</span>
                                    <h4 class="card-title">{{md.returnValues.Title}}</h4>
                                    <p class="card-text">{{md.returnValues.Content}}</p>

                                </div>
                            </div>
                            <!-- messageDatas -->
                        </div>
                    </div>
                </div>
            </div>
        </span>
        <!-- #5 ——————————————————————————————————————————————————————————————————————————————Info页面 -->

        <span v-if="pageNumber == 5">
            <div class="row">
                <div class="col-12">
                    <div class="card" style="background-color: rgba(0, 250, 154, 0.7);">
                        <div class="card-body">
                            <h4 class="card-title">Roam Loopss<span class="badge badge-pill badge-info">
                                    Loopss Nets</span></h4>
                            <button type="button" class="btn" @click="drawNets()" title="get nets">🕸</button>
                            <!-- <div class="jumbotron" id="cy"> -->

                            <div id="cy">

                            </div>
                            <span class="progress" style="background-color: rgba(106,181,177, 0.3);">
                                <span class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                    role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                                    :style="'width: '+ netProgressValue +'%'">
                                    {{netProgressValue}}%</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </span>
        <span v-if="pageNumber == 99">
            <div class="row">
                <div class="col-12">
                    <div class="card" style="background-color: rgba(127,220,227, 0.3);">
                        <div class="card-body">
                            ⏳L⏳O⏳A⏳D⏳I⏳N⏳G⏳……加载中，请稍等
                        </div>
                    </div>
                </div>
            </div>
        </span>
    </div>
    <!-- 调色：
    rgba(253,208,239, 0.3)
    241,210,189
    202,207,149
    133,199,163
    106,181,177
    127,220,227 -->
</body>



<script>
    var LoopsAddress = '0x0000000000000000000000000000000000000000';
    var LoopContract;
    web3js = new Web3(web3.currentProvider);

    // function rdm() {
    //     return String(Math.floor(Math.random() * 256) + ',');
    // }
    // var firstContractHigh = 21454192;
    var lt = self.setInterval("getNetwork()", 1000);
    function getNetwork() {
        if (LoopsAddress == '0x0000000000000000000000000000000000000000') {
            networkId = parseInt(ethereum.chainId);
            console.log(networkId)
            switch (networkId) {
                case 1://mainnet
                    LoopsAddress = "";
                    break;
                case 42://kovan
                    LoopsAddress = "0x697c8EF8f85cddD090Bb126746C71d72637c04F4";
                    app.LoopsAddress = LoopsAddress;
                    app.netWork = 'Kovan'
                    LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                    console.log('LoopsAddress@kovan:', LoopsAddress);
                    break;
                case 56://BSC
                    LoopsAddress = "0x697c8EF8f85cddD090Bb126746C71d72637c04F4";
                    app.LoopsAddress = LoopsAddress;
                    app.netWork = 'BSC'
                    LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                    console.log('LoopsAddress@BSC:', LoopsAddress);
                    break;
                case 1337://tf
                    LoopsAddress = "0x6a88674830C21b45efE45f286beF73a9f085a6Cf";
                    app.LoopsAddress = LoopsAddress;
                    app.netWork = 'Truffle'
                    LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                    console.log('LoopsAddress@TF:', LoopsAddress);
                    break;
                default:
                    break;
            }
            app.intervalRefresh();
            app.RefreshAccount();
            app.getMyLNS();
            // clearInterval(lt);
        }
        else {
            self.setInterval("app.intervalRefresh()", 20000);
            clearInterval(lt);
        }
    }
    //TODO 将上下两个change中switch的重用函数抽象
    ethereum.on('networkChanged', function (networkId) {
        networkId = parseInt(networkId)
        switch (networkId) {
            case 1://mainnet
                LoopsAddress = "";
                break;
            case 42://kovan
                LoopsAddress = "0x697c8EF8f85cddD090Bb126746C71d72637c04F4";
                app.netWork = 'Kovan'
                app.LoopsAddress = LoopsAddress;
                LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                console.log('LoopsAddress@kovan:', LoopsAddress);
                break;
            case 56://BSC
                LoopsAddress = "0x697c8EF8f85cddD090Bb126746C71d72637c04F4";
                app.LoopsAddress = LoopsAddress;
                app.netWork = 'BSC'
                console.log('LoopsAddress@BSC:', LoopsAddress);
                LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                app.getMyLNS();
                break;
            case 1337://tf
                LoopsAddress = "0x6a88674830C21b45efE45f286beF73a9f085a6Cf";
                app.LoopsAddress = LoopsAddress;
                app.netWork = 'Truffle'
                LoopContract = new web3js.eth.Contract(Loop_ABI, LoopsAddress);
                console.log('LoopsAddress@TF:', LoopsAddress);
                break;
            default:
                break;
        }
        app.intervalRefresh();
        app.RefreshAccount();

    })
    ethereum.on('accountsChanged', function (accounts) {
        //刷新初始化也会调用这个方法哦
        app.addressNow = web3.eth.defaultAccount;
        app.lookMyAddress = app.addressNow;
        app.YCoinList = [];
        // app.intervalRefresh();
        //TODO 切换账号的时候 查询界面数据还是没有刷新
        app.RefreshAccount();
        app.getMyLNS();
    })
    ethereum.enable();
    window.ethereum;
    // 成功之后这个会返回当前选择的账户
    web3js.eth.getAccounts().then(function (accounts) {
        //现在只能使用then异步的方式返回单个了
        console.log('Now account:', accounts);
    });


    var STORAGE_KEY = 'Loops';
    var DApp_Storage = {
        fetch: function () {
            //整个取
            var oracles = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            // 如果取不到就返回[]
            // oracles.forEach(function (oracle, index) {
            //   oracle.id = index
            // });
            // xxxStorage.uid = oracles.length; //这里是unitID的意思，单个item的ID
            return oracles
        },
        save: function (oracles) {
            //整个存
            localStorage.setItem(STORAGE_KEY, JSON.stringify(oracles))
        }
    };
    var myDate = new Date();
    function getLocalTime(nS) {
        return new Date(parseInt(nS) * 1000).toLocaleString().replace(/:\d{1,2}$/, ' ');
    }
    var app = new Vue({
        el: '#app',
        data: function () {
            return {
                LoopsAddress: LoopsAddress,
                // mvpAddress: MVPAddress,
                w3: web3js = new Web3(web3.currentProvider),
                zeroAddress: '0x0000000000000000000000000000000000000000',
                addressNow: LoopsAddress,
                addressLook: '',
                localDatas: DApp_Storage.fetch(),
                //宏观数据
                defaultPage: 5,
                netWork: 'UnSupportYet',
                TotalSupply: 0,
                SpiritComingEvents: '',
                blockHeight: 0,
                timeNow: myDate.toLocaleDateString() + '-' + myDate.toLocaleTimeString(),
                totalLPLocked1e18: '',
                classificationTexts: { 99: 'Click Left Side Button to show', 0: 'Wait me join', 1: 'My created, wait gote join', 2: 'My created, wait me to anneal', 3: 'My joined, wait init to anneal' },
                cfNumber: 99,
                pageNumber: 0,
                coinName: { 'Kovan': 'ETH', 'BSC': 'BNB' },
                blockExplorer: { 'Kovan': 'kovan.etherscan.io', 'BSC': 'bscscan.com' },
                trustType: { 1: 'Trusted', 2: 'Set Ratio' },
                //LNS解析相关
                AddressToLNS: '',
                LNSToAddress: '',
                toggleLNS: 0,
                //个人数据
                psLNS: '',
                mintedInWallet1e18: 0,
                mintedInWalletF: 0,
                trustData: { meToHim: { portion: 0, ratio: 1e18 }, heToMe: { portion: 0, ratio: 1e18 } },
                napsUnclaim1e18: 0,
                napsUnclaimF: 0,
                lpTokenLocked1e18: 0,
                lpTokenLockedF: 0,
                ethUnclaim1e18: 0,
                ethUnclaimF: 0,
                myLPproportion: 0,
                otherMintedInWallet1e18: 0,
                otherMintedInWalletF: 0,
                otherMintedLNS: '',
                lookMyAddress: LoopsAddress,//为了避免最开始获取时报错
                lookMinterAddress: '',
                lookTrustAddress: '',
                lookMessageAddress: '',
                trustLogs: {},
                sendOtherCoinToAddress: '',
                sendOtherCoinAmount: 0,
                YCoinList: [],
                // Loop swap Social Exchange
                loop_lanuchTokenAddress: '',
                loop_lanuchTokenLNS: '',
                loop_toSwapTokenLNS: '',
                loop_lanuchTokenBalance: 0,
                loop_toSwapTokenAddress: '',
                loop_IO: { input: 0, output: 0 },
                // loop_TokenLNS: '',
                loop_loops: {},
                loop_limitInput: 0,
                loop_estOutput: 0,
                loopInputd1e18: 0,
                loopOutputd1e18: 0,
                kIO: 0,
                // loop_start:default as addressNow

                // LNS
                LNSforAddress: '',
                CKAddressToLNS: '???',
                CKLNSToAddress: '',
                LNSText: '',
                LNSFee1e18: 0,
                LNSFeeF: '',

                LNSRegisterLog: '',
                LNSInviteLogs: '',
                AllLNSLogs: '',

                UnClaimBonus: 0,

                AccountInfoData: { realizedLNS_Profits1e18: 0 },
                //MSG数据
                messageChannel: 0,
                messageDatas: {},
                MessageSendToAddress: '',
                MessageSendToTitle: '',
                MessageSendToContent: '',
                msgGetCL: "∞",
                msgSendCL: 0,
                // Info nets roam loopss
                netDatas: [],
                netProgressValue: 0,
                //通知数据
                toastTitle: 'NASH #0 MVP',
                toastContent: 'Welcome to NASH protocol. This page is the interface of #0 MVP Contract which is the first contract of NASH——100 plan. \
                This toast will been used to show notification when get feedback from blockChain and will auto close in 5 mins.',
                //test
                dt: '',

            }
        },
        //声明周期
        beforeCreat() {

        },
        Created() {

        },
        beforeMount() {
            this.changePage(this.defaultPage);
            //先调用一次，避免update
            // this.updateToastAndShow('Welcome', "目前已经上线与Circles UBI同样的主网：xDAI，请添加以下参数：【Network Name: xDai New RPC -URL: https://xdai.poanetwork.dev】【ChainID (Optional): 100 】【Symbol: xDai】【Block Explorer URL: https://blockscout.com/poa/xdai】并切换到xDAI网络")
            this.updateToastAndShow('Welcome', "目前跨链前端正在开发中，应用天然跨链，目前已上线BSC 币安智能链主网，更多文档请查看主页页面的【了解更多🚀】")
        },
        mounted() {
            // this.updateToastAndShow('Welcome', "目前已经上线与Circles UBI同样的主网：xDAI，请添加以下参数：【Network Name: xDai New RPC -URL: https://xdai.poanetwork.dev】【ChainID (Optional): 100 】【Symbol: xDai】【Block Explorer URL: https://blockscout.com/poa/xdai】并切换到xDAI网络")
            this.updateToastAndShow('Welcome', "目前跨链前端正在开发中，应用天然跨链，目前已上线BSC 币安智能链主网，更多文档请查看主页页面的【了解更多🚀】")
            // this.intervalRefresh();
        },
        beforeUpdate() {

        },
        updated() {
            // 每次更新其他数据的时候会调用这个更新整个数据，所以不用再手动更新了。
            // this.delyRefresh();
            // console.log('ssss');
        },
        beforeDestory() {

        },

        destoryed() {

        },
        watch: {
            LNSforAddress: {
                handler: function (LNSforAddress) {
                    // todoStorage.save(todos)
                    this.AccountInfoData = {}
                },
                //TODO:这个deep啥意思？
                deep: true
            },
            LNSText: {
                handler: function (LNSText) {
                    // todoStorage.save(todos)
                    this.LNSFeeF = 0,
                        this.LNSFee1e18 = 0
                },
                //TODO:这个deep啥意思？
                deep: true
            },
            loopOutputd1e18: {
                handler: function (loopOutputd1e18) {
                    // todoStorage.save(todos)
                    // this.AccountInfoData = {}
                    this.loopInputd1e18 = this.kIO * loopOutputd1e18
                },
                //TODO:这个deep啥意思？
                deep: true
            },
            loopInputd1e18: {
                handler: function (loopInputd1e18) {
                    // todoStorage.save(todos)
                    // this.AccountInfoData = {}
                    this.loopOutputd1e18 = loopInputd1e18 / this.kIO
                },
                //TODO:这个deep啥意思？
                deep: true
            }
        },
        //方法
        methods: {
            // // 国际化
            // // internationalization(_lg) {
            // //     if (_lg == 'zh') {
            // //         this.title = '{{GovHoeTokenName}} 治理'
            // //     } else if (_lg == 'en') {
            // //         this.title = '{{GovHoeTokenName}} Gov'
            // //     }
            // // },
            // copy(obj) {
            //     obj.focus();
            //     document.execCommand("Copy"); // 执行浏览器复制命令
            //     // this.$message({
            //     //     message: '复制成功',
            //     //     type: 'success'
            //     // });
            // },
            //—————————————————————————————————————————————————Public——————————————————————————————————————————————————————————————
            clipboardSuccess() {
                this.updateToastAndShow('CP', '地址长度错误@查询其他代币余额');
            },
            rdm() {
                return String(Math.floor(Math.random() * 256) + ',');
            },
            async changePage(_pageNumber) {
                switch (_pageNumber) {
                    case 0:

                        break;
                    case 1://查询
                        this.lookMyAddress = this.addressNow;
                        this.pageNumber = 99;
                        await this.getMyMintingInWallet();
                        //TODO 更新进度条
                        this.getYCoinList();

                        break;
                    case 2://LNS
                        this.LNSforAddress = this.addressNow;
                        break;
                    case 3://Swap
                        this.loop_lanuchTokenAddress = this.addressNow;
                        this.lookMinterAddress = this.addressNow;
                        break;
                    case 4://Msg
                        this.lookMessageAddress = this.addressNow;
                        break;
                    case 5:
                        this.netProgressValue = 0;
                        break;
                    default:
                        break;
                }
                this.pageNumber = _pageNumber;
            },
            // 数据处理方法
            _formatBigNumber(_bn) {
                // return web3js.utils.fromWei(_bn, 'ether');
                return parseFloat(web3js.utils.fromWei(_bn, 'ether')).toLocaleString();
                // parseFloat().toLocaleString();
            },
            // 数据获取方法
            async intervalRefresh() {
                // this.internationalization(lg);
                await this.getBlockHeight();
                await this.getLoopTotalSupply();
                this.getMyMintingInWallet();
            },
            delyRefresh() {
                this.getMyMintingInWallet();
                // this.getMyLNS();
                // this.getMyBentoInBank();
                // this.getGovBalance();
                // this.getGovLockedAmount();
                // this.getBentoMiningSpeed();
                // this.getMyMiningPercentage()
            },
            getLoopTotalSupply() {
                LoopContract.methods.totalSupply().call().then((rst) => {
                    this.TotalSupply = this._formatBigNumber(rst);
                    // this.govTotalLockedF = this._formatBigNumber(rst);
                    console.log(rst);
                })
            },
            RefreshAccount() {
                this.addressNow = web3.eth.defaultAccount;
                // this.lookMessageAddress = this.addressNow;
            },
            async getMyLNS() {
                this.psLNS = await LoopContract.methods.LoopNameSystem_Reverse(this.addressNow).call();
                // console.log(this.psLNS)
                if (this.psLNS == '') this.psLNS = this.addressNow.substring(0, 5);
                // console.log('LNS:' + this.psLNS)
            },
            getBlockHeight() {
                web3js.eth.getBlockNumber().then((rst) => { this.blockHeight = rst; console.log(rst) })
            },
            // 数据展示方法
            updateToastAndShow(title, content) {
                myDate = new Date();
                this.timeNow = myDate.toLocaleDateString() + '-' + myDate.toLocaleTimeString();
                this.toastTitle = title;
                this.toastContent = content;
                $('.toast').toast('show');
            },
            //—————————————————————————————————————————————————查询———————————————————————————————————————————————————————————————
            getMyMinterAndCoinList() {
                (this.getMyMintingInWallet()) && (this.getYCoinList())
            },
            async getMyMintingInWallet() {
                // console.log()
                this.mintedInWallet1e18 = await LoopContract.methods.balanceOf(this.lookMyAddress).call();
                this.mintedInWalletF = this._formatBigNumber(this.mintedInWallet1e18);
                this.myLPproportion = (this.mintedInWallet1e18 / 1e18) / 10;
            },
            async getMinterBalanceOf() {
                if (this.lookMinterAddress.length != 42) {
                    this.updateToastAndShow('Address error', '地址长度错误@查询其他代币余额');
                    return;
                }
                this.updateToastAndShow('Other balance', '⏳请求中');
                this.otherMintedLNS = await LoopContract.methods.LoopNameSystem_Reverse(this.lookMinterAddress).call();
                if (this.otherMintedLNS == '') {
                    this.otherMintedLNS = ''
                    this.updateToastAndShow('Other balance', '⏳请求中.代币无LNS，无代币符号');
                }
                if (this.lookMinterAddress == this.addressNow) {
                    this.otherMintedInWallet1e18 = await LoopContract.methods.netBalanceOf(this.lookMinterAddress).call();
                } else {
                    this.otherMintedInWallet1e18 = await LoopContract.methods.minterBalanceOf(this.lookMinterAddress, this.lookMyAddress).call();
                }
                this.otherMintedInWalletF = this._formatBigNumber(this.otherMintedInWallet1e18);
                this.updateToastAndShow('Other balance', '获取成功');
                // console.log(this.otherMintedInWallet1e18)
            },
            async getTrustState() {
                if (this.lookTrustAddress.length != 42) {
                    this.updateToastAndShow('Address error', '地址长度错误@查询信任关系');
                    return;
                }
                this.updateToastAndShow('Trust State', '请求中');
                // 请求 我对他{程度，比例} 他对我{程度，比例}
                // getProportionReceiverTrustedSender
                // getRatioReceiver100TokenForSender
                let cache = this.trustData;

                let rst = await LoopContract.methods.getTrustStatesForAB(this.lookMyAddress, this.lookTrustAddress).call();
                // console.log(rst);
                cache.meToHim.portion = rst[0];
                cache.heToMe.portion = rst[2];
                cache.meToHim.ratio = rst[1];
                cache.heToMe.ratio = rst[3];
                this.trustData = cache;
                // console.log(this.trustData)
                this.updateToastAndShow('Trust State', '获取成功');
            },
            async getYCoinList() {
                this.YCoinList = [];
                // 获取My地址信任过的TrustLog
                let trustedList = (await LoopContract.getPastEvents('TrustEvent', { filter: { TrustSender: this.lookMyAddress }, fromBlock: 0 }))//.reverse();
                // 在Log中去重 被 信任方 得到set
                // console.log(trustedList);
                let beenTrustList = new Set();
                for (let i = 0; i < trustedList.length; i++) {
                    beenTrustList.add(trustedList[i].returnValues.BeenTrusted)
                }
                beenTrustList = [...beenTrustList]
                // this.dt = beenTrustList;
                // 遍历set获取【LNS | 缩写地址：】代币 ：余额

                for (let i = 0; i < beenTrustList.length; i++) {
                    let YTAds = beenTrustList[i]//Y Token address
                    // let cLNS;
                    let cLNS = await LoopContract.methods.LoopNameSystem_Reverse(YTAds).call();
                    if (cLNS == '') {
                        cLNS = YTAds.substring(0, 5)
                    }
                    let cBlc = await LoopContract.methods.minterBalanceOf(YTAds, this.lookMyAddress).call();
                    this.YCoinList.push([YTAds, cLNS, cBlc])
                }
            },
            async getMyTrusted() {
                this.updateToastAndShow('Trust Logs', '⏳Fetching My Trusted🤝 Logs');
                this.trustLogs = (await LoopContract.getPastEvents('TrustEvent', { filter: { TrustSender: this.lookMyAddress }, fromBlock: 0 })).reverse();//.pop().returnValues.Creater;
                this.updateToastAndShow('Trust Logs', '✅Fetched My Trusted🤝 Logs');
            },
            async getTrustedMe() {
                this.updateToastAndShow('Trust Logs', '⏳Fetching Trusted Me 👭 Logs');
                this.trustLogs = (await LoopContract.getPastEvents('TrustEvent', { filter: { BeenTrusted: this.lookMyAddress }, fromBlock: 0 })).reverse();//.pop().returnValues.Creater;
                this.updateToastAndShow('Trust Logs', '✅Fetched Trusted Me 👭 Logs');
            },
            //—————————————————————————————————————————————————MSG———————————————————————————————————————————————————————————————
            async getAllMsg() {

                if (this.msgGetCL == '∞') {
                    this.updateToastAndShow('Social Message', `⏳Fetching ALL Message……`);
                    this.messageDatas = (await LoopContract.getPastEvents('SocialMessage', { fromBlock: 0 })).reverse();
                } else {
                    this.updateToastAndShow('Social Message', `⏳Fetching 📶Channel: ${this.msgGetCL} Message……`);
                    this.messageDatas = (await LoopContract.getPastEvents('SocialMessage', { filter: { Channel: this.msgGetCL }, fromBlock: 0 })).reverse();
                }
                this.updateToastAndShow('Social Message', `✅Fetching ALL Message`);
            },
            async getRecMsg() {
                if (this.lookMessageAddress.length != 42) {
                    this.updateToastAndShow('Address❌', '地址长度错误@查询社交消息');
                    return;
                }
                let rst;
                this.updateToastAndShow('Social Message', `请求⏳【${this.lookMessageAddress}】接收的消息`);
                if (this.msgGetCL == "∞") {
                    rst = await LoopContract.getPastEvents('SocialMessage', { filter: { Receiver: this.lookMessageAddress }, fromBlock: 0 });
                } else {
                    rst = await LoopContract.getPastEvents('SocialMessage', { filter: { Receiver: this.lookMessageAddress, Channel: this.msgGetCL }, fromBlock: 0 });
                    //0 channel由于web3的问题需要特殊处理
                    if (this.msgGetCL == 0) {
                        var cache = [];
                        for (ml in rst) {
                            // console.log(rst[ml])
                            if (rst[ml].returnValues.Channel == "0") {
                                cache.push(rst[ml]);
                            }
                        }
                        rst = cache;
                    }
                }
                this.updateToastAndShow('Social Message', `请求成功✅`);
                this.messageDatas = rst.reverse();;
                // console.log(rst)
            },
            async getSentMsg() {
                if (this.lookMessageAddress.length != 42) {
                    this.updateToastAndShow('Address❌', '地址长度错误@查询社交消息');
                    return;
                }
                let rst;
                this.updateToastAndShow('Social Message', `请求⏳【${this.lookMessageAddress}】发出的消息`);
                if (this.msgGetCL == "∞") {
                    rst = await LoopContract.getPastEvents('SocialMessage', { filter: { Sender: this.lookMessageAddress }, fromBlock: 0 });
                } else {
                    rst = await LoopContract.getPastEvents('SocialMessage', { filter: { Sender: this.lookMessageAddress, Channel: this.msgGetCL }, fromBlock: 0 });
                    //0 channel由于web3的问题需要特殊处理
                    if (this.msgGetCL == 0) {
                        var cache = [];
                        for (ml in rst) {
                            // console.log(rst[ml])
                            if (rst[ml].returnValues.Channel == "0") {
                                cache.push(rst[ml]);
                            }
                        }
                        rst = cache;
                    }

                }
                this.updateToastAndShow('Social Message', `请求成功✅`);
                this.messageDatas = rst.reverse();;
                // console.log(rst)
            },

            async sendMsg() {
                if (this.MessageSendToAddress == '' || this.MessageSendToTitle == '' || this.MessageSendToContent == '') {
                    this.updateToastAndShow('Send Message', '❌数据不全');
                    return;
                }
                this.updateToastAndShow('Send Message', '⏳Pending……');

                let rst = await LoopContract.methods.sendSocialMessage(this.msgSendCL, this.MessageSendToTitle, this.MessageSendToContent, this.MessageSendToAddress).send({ from: web3.eth.defaultAccount });
                console.log(rst);
                this.updateToastAndShow('Send Message', '👌Sent success');

            },
            //—————————————————————————————————————————————————LNS———————————————————————————————————————————————————————————————
            //TODO 显示总的LNS er
            async LNSResolution() {
                if (this.LNSToAddress == '') {
                    this.updateToastAndShow('Resolution LNS', '❌Please input LNS for resolution Address');
                    return
                }
                this.updateToastAndShow('Resolution LNS', '⏳Fetching LNS → Address');
                this.AddressToLNS = await LoopContract.methods.LoopNameSystem_Resolution(this.LNSToAddress).call();
                this.updateToastAndShow('Resolution LNS', '✅Fetching LNS → Address');
            },
            async LNSReverse() {
                if (this.AddressToLNS == '') {
                    this.updateToastAndShow('Reverse LNS', '❌Please input Address for Reverse LNS');
                    return
                } else if (this.AddressToLNS.length != 42) {
                    this.updateToastAndShow('Reverse LNS', '❌Address Error.');
                    return
                }
                this.updateToastAndShow('Reverse LNS', '⏳Fetching Address → LNS');
                this.LNSToAddress = await LoopContract.methods.LoopNameSystem_Reverse(this.AddressToLNS).call();
                this.updateToastAndShow('Reverse LNS', '✅Fetching Address → LNS');
            },
            async checkLNS() {
                if (this.LNSText == '') {
                    this.updateToastAndShow('Register LNS', '❌Please input LNS');
                    return;
                }
                this.updateToastAndShow('Register LNS', 'Check:⏳Pending……');
                this.LNSFee1e18 = await LoopContract.methods.registerFee(this.LNSText).call();
                this.LNSFeeF = this._formatBigNumber(this.LNSFee1e18);
                this.CKLNSToAddress = await LoopContract.methods.LoopNameSystem_Resolution(this.LNSText).call();
                // console.log(rst);
                if (this.CKLNSToAddress == this.zeroAddress) {
                    this.CKAddressToLNS = await LoopContract.methods.LoopNameSystem_Reverse(this.LNSforAddress).call();
                    if (this.CKAddressToLNS != '') {
                        this.updateToastAndShow('Register LNS', 'Notice：⚠️Name Available to register, but  ' + this.LNSforAddress + ' already named :【' + this.CKAddressToLNS + '】');
                        return
                    }
                    this.updateToastAndShow('Register LNS', 'Check: ✅Name Available to register');
                } else {
                    this.updateToastAndShow('Register LNS', 'Check: ❌Registered by：' + this.CKLNSToAddress);
                }
            },
            async registerLNS() {
                if (this.LNSText == '') {
                    this.updateToastAndShow('Register LNS', '❌Please input LNS');
                    return;
                }
                this.updateToastAndShow('Register LNS', 'Register LNS:⏳Pending……');
                await LoopContract.methods.registerLNS(this.LNSText, this.LNSforAddress).send({ from: web3.eth.defaultAccount, value: this.LNSFee1e18 });
                this.updateToastAndShow('Register LNS', 'Register LNS:✅Success');
                this.getMyLNS();
            },
            async getLNSRegisterLog() {
                if (this.LNSforAddress == '' || this.LNSforAddress == undefined) {
                    this.updateToastAndShow('Fetch LNS log', '❌Please input (For) address.');
                    return;
                }
                this.updateToastAndShow('Fetch LNS log', '⏳Fetching……');
                this.LNSRegisterLog = (await LoopContract.getPastEvents('NewLNS', { filter: { Owner: this.LNSforAddress }, fromBlock: 0 })).reverse();
                this.updateToastAndShow('Fetch LNS log', '✅Success：' + this.LNSRegisterLog.length + ' items');

            },
            async getLNSInviteLogs() {
                if (this.LNSforAddress == '' || this.LNSforAddress == undefined) {
                    this.updateToastAndShow('Fetch LNS logs', '❌Please input (For) address.');
                    return;
                }
                this.updateToastAndShow('Fetch LNS logs', '⏳Fetching……');
                this.LNSInviteLogs = (await LoopContract.getPastEvents('NewLNS', { filter: { Inviter: this.LNSforAddress }, fromBlock: 0 })).reverse();
                this.updateToastAndShow('Fetch LNS logs', '✅Success：' + this.LNSInviteLogs.length + ' items');
            },
            async getAllLNSLogs() {
                this.updateToastAndShow('Fetch All LNS logs', '⏳Fetching……');
                this.AllLNSLogs = (await LoopContract.getPastEvents('NewLNS', { fromBlock: 0 })).reverse();
                this.updateToastAndShow('Fetch All LNS logs', '✅Success：' + this.AllLNSLogs.length + ' items');
            },
            async getUnClaimBonus(ucAddress) {
                this.UnClaimBonus = await LoopContract.methods.unClaimBonusOf(ucAddress).call();
            },
            async getAccountInfo() {
                this.UnClaimBonus = 0;
                if (this.LNSforAddress == '' || this.LNSforAddress == undefined) {
                    this.updateToastAndShow('Account info', '❌Please input (For) address.');
                    return;
                }
                this.updateToastAndShow('Account info', '⏳Fetching……');
                this.LNSRegisterLog = await LoopContract.getPastEvents('NewLNS', { filter: { Owner: this.LNSforAddress }, fromBlock: 0 })
                this.AccountInfoData = await LoopContract.methods.getAccountInfoOf(this.LNSforAddress).call();
                // if (this.LNSforAddress == this.addressNow) {
                this.getUnClaimBonus(this.LNSforAddress);
                // }
                this.updateToastAndShow('Account info', '✅Succes');
            },
            async ClaimBonus() {
                this.updateToastAndShow('Claim Bonus', '⏳Pending');
                await LoopContract.methods.claim().send({ from: web3.eth.defaultAccount });
                this.updateToastAndShow('Claim Bonus', '✅Succes');
            },
            //—————————————————————————————————————————————————Swap———————————————————————————————————————————————————————————————
            async sendOtherCoin() {
                // sendOtherCoinToAddress
                // sendOtherCoinAmount
                if (this.sendOtherCoinToAddress == '' || this.sendOtherCoinAmount == '') {
                    this.updateToastAndShow('Send Other Coin', '❌数据不全');
                    return;
                }
                this.updateToastAndShow('Send Other Coin', '⏳Pending……');
                let rst = await LoopContract.methods.loopTransfer([this.sendOtherCoinToAddress], web3js.utils.toWei(String(this.sendOtherCoinAmount)), 0, this.lookMinterAddress).send({ from: web3.eth.defaultAccount });
                this.getMinterBalanceOf();
                this.updateToastAndShow('Send Other Coin', '👌Sent success');
            },

            async checkLaunchBalance() {
                if (this.loop_lanuchTokenAddress.length != 42) {
                    this.updateToastAndShow('社会交易所@余额', '❌Check Launch balacne address error');
                    return;
                }
                this.updateToastAndShow('社会交易所@余额', '⏳Fetching Launch balacne');
                this.loop_lanuchTokenBalance = this.loop_lanuchTokenAddress == this.addressNow ? (await LoopContract.methods.netBalanceOf(this.addressNow).call()) : (await LoopContract.methods.minterBalanceOf(this.loop_lanuchTokenAddress, this.addressNow).call());
                this.loop_lanuchTokenLNS = await LoopContract.methods.LoopNameSystem_Reverse(this.loop_lanuchTokenAddress).call();
                this.updateToastAndShow('社会交易所@余额', '✅Fetched Launch balacne');


            },
            async startSwap(lanuchTokenAddress) {
                //跳转页面，填入使用代币地址loop_lanuchTokenAddress，loop_lanuchTokenLNS，填入可用量loop_lanuchTokenBalance
                this.changePage(3);
                this.loop_lanuchTokenAddress = lanuchTokenAddress;
                this.checkLaunchBalance()
                // 填入转出异币的地址并填入余额：this.getMinterBalanceOf(),this.getLoopAvailableAmount(),this.sendOtherCoin()
                this.lookMinterAddress = lanuchTokenAddress;
                this.getMinterBalanceOf()
            },
            async getLoopAvailableAmount() {
                // start point : addressNow
                // useToken loop_lanuchTokenAddress
                // loops:[loop_toSwapTokenAddress,addressNow]
                if (this.loop_toSwapTokenAddress.length != 42) {
                    this.updateToastAndShow('社会交易所@可用', '❌Get Loop Available address error');
                    return
                }
                // loop_toSwapTokenLNS
                this.updateToastAndShow('社会交易所@可用', '⏳Fetching Loop Available');
                this.loop_IO = await LoopContract.methods.loopAvailableAmount(this.addressNow, [this.loop_toSwapTokenAddress, this.addressNow], this.loop_lanuchTokenAddress).call()
                this.kIO = this.loop_IO.input / this.loop_IO.output;
                this.loopInputd1e18 = this.loop_IO.input / 1e18;
                this.loopOutputd1e18 = this.loop_IO.output / 1e18;
                this.loop_toSwapTokenLNS = await LoopContract.methods.LoopNameSystem_Reverse(this.loop_toSwapTokenAddress).call();
                this.updateToastAndShow('社会交易所@可用', '✅Fetched Loop Available');

            },
            async loopSwap() {
                if (this.loopInputd1e18 > this.loop_IO.input / 1e18 || this.loopOutputd1e18 > this.loop_IO.input / 1e18) {
                    this.updateToastAndShow('社会交易所@交易', '❌Input&Output out of range');
                    return
                }
                this.updateToastAndShow('社会交易所@交易', '⏳Sending Loop Transfer');
                let rst = await LoopContract.methods.loopTransfer([this.loop_toSwapTokenAddress, this.addressNow], web3js.utils.toWei(String(this.loopInputd1e18)), web3js.utils.toWei(String(this.loopOutputd1e18)), this.loop_lanuchTokenAddress)
                .send({ from: web3.eth.defaultAccount });
                this.updateToastAndShow('社会交易所@交易', '✅Sent Loop Transfer');

            },
            //—————————————————————————————————————————————————info———————————————————————————————————————————————————————————————
            async toTransfer(to,value){
                await LoopContract.methods.transfer(to,web3js.utils.toWei(String(value))).send({ from: web3.eth.defaultAccount });
            },
            async drawNets() {
                this.netProgressValue = 0;
                // netDatas
                let cacheNetDatas = (await LoopContract.getPastEvents('TrustEvent', { filter: { TrustSender: this.addressNow }, fromBlock: 0 })).reverse();
                let setList = [];
                let filter = {};
                for (let i = 0; i < cacheNetDatas.length; i++) {
                    // console.log(i,cacheNetDatas[i].returnValues.BeenTrusted,filter[cacheNetDatas[i].returnValues.BeenTrusted])
                    if (filter[cacheNetDatas[i].returnValues.BeenTrusted] == undefined) {
                        // console.log(i)
                        filter[cacheNetDatas[i].returnValues.BeenTrusted] = 1;
                        setList.push(cacheNetDatas[i]);
                    }
                }

                this.netDatas = setList;
                console.log(this.netDatas);
                let myNodes = [];
                let myEdges = [];
                let cacheData;
                for (let i = 0; i < setList.length; i++) {

                    let YTAds = setList[i].returnValues.BeenTrusted//Y Token address
                    // console.log(YTAds)
                    let cLNS = await LoopContract.methods.LoopNameSystem_Reverse(YTAds).call();
                    if (cLNS == '') {
                        cLNS = YTAds.substring(0, 5)
                    }
                    // console.log(cLNS)
                    cacheData = { data: { id: YTAds, name: cLNS } };
                    myNodes.push(cacheData)
                    cacheData = { data: { source: this.addressNow, target: YTAds, label: setList[i].returnValues.TrustValue + '%' }, classes: 'autorotate' };
                    myEdges.push(cacheData)
                    if (i == parseInt(setList.length / 2)) {
                        // console.log(cLNS);
                        myNodes.push({ data: { id: this.addressNow, name: this.psLNS } })
                    }
                    this.netProgressValue = ((i + 1) / setList.length) * 100;
                }
                let _nodes = myNodes;
                let _edges = myEdges;
                // let _nodes = [
                //     { data: { id: 'j', name: 'Jerry' } },
                //     { data: { id: 'e', name: 'Elaine' } },
                //     { data: { id: 'k', name: 'Kramer' } },
                //     { data: { id: 'g', name: 'George' } }
                // ]
                // let _edges = [
                //     { data: { source: 'j', target: 'e' } },
                //     { data: { source: 'j', target: 'k' } },
                //     { data: { source: 'j', target: 'g' } },
                //     { data: { source: 'e', target: 'j' } },
                //     { data: { source: 'e', target: 'k' } },
                //     { data: { source: 'k', target: 'j' } },
                //     { data: { source: 'k', target: 'e' } },
                //     { data: { source: 'k', target: 'g' } },
                //     { data: { source: 'g', target: 'j' } }
                // ]



                var cy = cytoscape({
                    container: document.getElementById('cy'),
                    ready: function () {
                    },
                    // layout: {
                    //     name: 'grid',
                    //     rows: Math.sqrt(setList.length),
                    //     cols: Math.sqrt(setList.length)
                    // },

                    style: [
                        {
                            selector: 'node[name]',
                            style: {
                                'content': 'data(name)'
                            }
                        },

                        {
                            selector: 'edge',
                            style: {
                                'curve-style': 'bezier',
                                'target-arrow-shape': 'triangle'
                            }
                        },

                        {
                            "selector": "node[label]",
                            "style": {
                                "label": "data(label)"
                            }
                        },

                        {
                            "selector": "edge[label]",
                            "style": {
                                "label": "data(label)",
                                "color": "#fff",
                                "width": 3
                            }
                        },


                        {
                            "selector": ".autorotate",
                            "style": {
                                "edge-text-rotation": "autorotate"
                            }
                        }

                        // some style for the extension

                        // {
                        //     selector: '.eh-handle',
                        //     style: {
                        //         'background-color': 'red',
                        //         'width': 12,
                        //         'height': 12,
                        //         'shape': 'ellipse',
                        //         'overlay-opacity': 0,
                        //         'border-width': 12, // makes the handle easier to hit
                        //         'border-opacity': 0
                        //     }
                        // },

                        // {
                        //     selector: '.eh-hover',
                        //     style: {
                        //         'background-color': 'red'
                        //     }
                        // },

                        // {
                        //     selector: '.eh-source',
                        //     style: {
                        //         'border-width': 2,
                        //         'border-color': 'red'
                        //     }
                        // },

                        // {
                        //     selector: '.eh-target',
                        //     style: {
                        //         'border-width': 2,
                        //         'border-color': 'red'
                        //     }
                        // },

                        // {
                        //     selector: '.eh-preview, .eh-ghost-edge',
                        //     style: {
                        //         'background-color': 'red',
                        //         'line-color': 'red',
                        //         'target-arrow-color': 'red',
                        //         'source-arrow-color': 'red'
                        //     }
                        // },

                        // {
                        //     selector: '.eh-ghost-edge.eh-preview-active',
                        //     style: {
                        //         'opacity': 0
                        //     }
                        // }
                    ],

                    elements: {
                        nodes: _nodes,
                        edges: _edges
                    }
                });
                cy.cxtmenu({
                    selector: 'node',

                    commands: [
                        {
                            content: 'CopyAddress',
                            select: function (ele) {
                                console.log(ele.id());
                            }
                        },

                        {
                            content: 'CheckLNS',
                            select: function (ele) {
                                console.log(ele.data('name'));
                            },
                            // enabled: true
                        },

                        {
                            content: 'SendMsg',
                            select: function (ele) {
                                console.log(ele.position());
                            }
                        }
                    ]
                });

                cy.cxtmenu({
                    selector: 'edge',

                    commands: [
                        {
                            content: 'reset',
                            select: function (ele) {
                                console.log(ele);
                            }
                        },

                        {
                            content: 'delete',
                            select: function (ele) {
                                // xdt = ele;
                                // console.log(xdt);
                                app.toTransfer(ele["_private"]["data"]["target"],0)
                            }
                        }
                    ]
                });
            },

        }
    })
var xdt;
    var clipboard = new ClipboardJS('.toCopy');

    clipboard.on('success', function (e) {
        console.log(e);
        app.updateToastAndShow('Copy', '✅Copied: ' + e.text);
    });

    clipboard.on('error', function (e) {
        console.log(e);
    });

</script>

<!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script> -->



</html>